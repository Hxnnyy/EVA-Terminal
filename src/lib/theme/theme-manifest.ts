// Theme tokens are source of truth for palettes; buildThemeCss converts to .theme-* classes.
export type ThemeId = 'eoe' | 'eva01' | 'eva02' | 'eva00';

export const THEME_CLASS_PREFIX = 'theme-';
export const THEME_STYLE_ELEMENT_ID = 'eva-theme-manifest';

type ThemeTokens = Record<string, string>;

type ThemeDefinition = {
  id: ThemeId;
  label: string;
  tokens: ThemeTokens;
};

const createTheme = (definition: ThemeDefinition) => definition;

const THEME_MANIFEST: Record<ThemeId, ThemeDefinition> = {
  eoe: createTheme({
    id: 'eoe',
    label: 'EOE',
    tokens: {
      '--surface-base': '#02041a',
      '--surface-base-rgb': '2, 4, 26',
      '--surface-elevated': '#090e29',
      '--surface-elevated-rgb': '9, 14, 41',
      '--surface-contrast': '#010212',
      '--surface-contrast-rgb': '1, 2, 18',
      '--grid-color': 'rgba(var(--accent-primary-rgb), 0.2)',
      '--grid-line': 'rgba(86, 142, 216, 0.16)',
      '--text-primary': '#f0f4ff',
      '--text-primary-rgb': '240, 244, 255',
      '--text-secondary': '#8b97ff',
      '--text-secondary-rgb': '139, 151, 255',
      '--accent-primary': '#ff7a49',
      '--accent-primary-rgb': '255, 122, 73',
      '--accent-secondary': '#56c5ff',
      '--accent-secondary-rgb': '86, 197, 255',
      '--accent-tertiary': '#e989ff',
      '--accent-tertiary-rgb': '233, 137, 255',
      '--accent-amber': '#ffbe5e',
      '--accent-amber-rgb': '255, 190, 94',
      '--accent-emerald': '#6dffb5',
      '--accent-emerald-rgb': '109, 255, 181',
      '--accent-cyan': '#63e3ff',
      '--accent-cyan-rgb': '99, 227, 255',
      '--accent-pink': '#ff6ba8',
      '--accent-pink-rgb': '255, 107, 168',
      '--terminal-border': 'rgba(var(--accent-primary-rgb), 0.35)',
      '--glow-strength': '0.85',
      '--horizon-warm': 'rgba(255, 109, 74, 0.68)',
      '--horizon-hot': 'rgba(255, 88, 142, 0.6)',
      '--horizon-cool': 'rgba(18, 46, 112, 0.42)',
      '--bg-linear-0': 'rgba(4, 10, 30, 0.98)',
      '--bg-linear-1': 'rgba(10, 20, 52, 0.95)',
      '--bg-linear-2': 'rgba(24, 40, 90, 0.88)',
      '--bg-linear-3': 'rgba(102, 60, 134, 0.56)',
      '--bg-linear-4': 'rgba(204, 78, 107, 0.44)',
      '--bg-linear-5': 'rgba(236, 102, 62, 0.42)',
      '--bg-linear-6': 'rgba(30, 8, 22, 0.92)',
      '--bg-radial-1': 'rgba(255, 134, 104, 0.26)',
      '--bg-radial-2': 'rgba(66, 122, 218, 0.24)',
      '--bg-before-radial-strong': 'rgba(255, 120, 88, 0.64)',
      '--bg-before-radial-soft': 'rgba(255, 120, 88, 0.1)',
      '--bg-before-linear-top': 'rgba(6, 12, 32, 0.08)',
      '--bg-before-linear-mid': 'rgba(6, 12, 32, 0.48)',
      '--bg-before-linear-bottom': 'rgba(6, 12, 32, 0.94)',
      '--bg-before-glow': 'rgba(255, 104, 72, 0.28)',
      '--bg-after-grid': 'rgba(255, 255, 255, 0.08)',
      '--bg-after-star-1': 'rgba(255, 255, 255, 0.5)',
      '--bg-after-star-2': 'rgba(225, 166, 245, 0.4)',
      '--bg-after-star-3': 'rgba(98, 175, 255, 0.4)',
      '--bg-after-star-4': 'rgba(255, 160, 118, 0.3)',
      '--bg-after-star-5': 'rgba(255, 255, 255, 0.28)',
      '--bg-after-star-6': 'rgba(246, 104, 157, 0.38)',
      '--bg-after-haze-top': 'rgba(4, 10, 30, 1)',
      '--bg-after-haze-bottom': 'rgba(4, 10, 30, 0)',
    },
  }),
  eva01: createTheme({
    id: 'eva01',
    label: 'EVA-01',
    tokens: {
      '--surface-base': '#140a24',
      '--surface-base-rgb': '20, 10, 36',
      '--surface-elevated': '#1d1139',
      '--surface-elevated-rgb': '29, 17, 57',
      '--surface-contrast': '#0b0618',
      '--surface-contrast-rgb': '11, 6, 24',
      '--grid-color': 'rgba(108, 255, 138, 0.24)',
      '--grid-line': 'rgba(167, 120, 255, 0.18)',
      '--text-primary': '#f1f5ff',
      '--text-primary-rgb': '241, 245, 255',
      '--text-secondary': '#beb5ff',
      '--text-secondary-rgb': '190, 181, 255',
      '--accent-primary': '#69f78b',
      '--accent-primary-rgb': '105, 247, 139',
      '--accent-secondary': '#ffd45a',
      '--accent-secondary-rgb': '255, 212, 90',
      '--accent-tertiary': '#c68bff',
      '--accent-tertiary-rgb': '198, 139, 255',
      '--accent-amber': '#ffd45a',
      '--accent-amber-rgb': '255, 212, 90',
      '--accent-emerald': '#69f78b',
      '--accent-emerald-rgb': '105, 247, 139',
      '--accent-cyan': '#8be5ff',
      '--accent-cyan-rgb': '139, 229, 255',
      '--accent-pink': '#d78bff',
      '--accent-pink-rgb': '215, 139, 255',
      '--terminal-border': 'rgba(105, 247, 139, 0.32)',
      '--horizon-warm': 'rgba(109, 226, 146, 0.58)',
      '--horizon-hot': 'rgba(221, 189, 98, 0.5)',
      '--horizon-cool': 'rgba(96, 142, 216, 0.36)',
      '--bg-linear-0': 'rgba(20, 10, 36, 0.98)',
      '--bg-linear-1': 'rgba(30, 16, 56, 0.94)',
      '--bg-linear-2': 'rgba(44, 24, 78, 0.9)',
      '--bg-linear-3': 'rgba(68, 38, 112, 0.62)',
      '--bg-linear-4': 'rgba(112, 60, 132, 0.5)',
      '--bg-linear-5': 'rgba(178, 122, 88, 0.36)',
      '--bg-linear-6': 'rgba(16, 10, 30, 0.92)',
      '--bg-radial-1': 'rgba(110, 255, 128, 0.28)',
      '--bg-radial-2': 'rgba(255, 204, 102, 0.24)',
      '--bg-before-radial-strong': 'rgba(128, 255, 184, 0.58)',
      '--bg-before-radial-soft': 'rgba(255, 210, 120, 0.12)',
      '--bg-before-linear-top': 'rgba(18, 20, 48, 0.1)',
      '--bg-before-linear-mid': 'rgba(24, 28, 64, 0.52)',
      '--bg-before-linear-bottom': 'rgba(16, 12, 36, 0.94)',
      '--bg-before-glow': 'rgba(128, 255, 180, 0.24)',
      '--bg-after-grid': 'rgba(168, 255, 200, 0.08)',
      '--bg-after-star-1': 'rgba(128, 255, 200, 0.45)',
      '--bg-after-star-2': 'rgba(208, 168, 255, 0.36)',
      '--bg-after-star-3': 'rgba(110, 255, 178, 0.32)',
      '--bg-after-star-4': 'rgba(255, 220, 128, 0.26)',
      '--bg-after-star-5': 'rgba(255, 255, 220, 0.22)',
      '--bg-after-star-6': 'rgba(200, 160, 255, 0.3)',
      '--bg-after-haze-top': 'rgba(18, 12, 40, 1)',
      '--bg-after-haze-bottom': 'rgba(18, 12, 40, 0)',
    },
  }),
  eva02: createTheme({
    id: 'eva02',
    label: 'EVA-02',
    tokens: {
      '--surface-base': '#1c0709',
      '--surface-base-rgb': '28, 7, 9',
      '--surface-elevated': '#260b0f',
      '--surface-elevated-rgb': '38, 11, 15',
      '--surface-contrast': '#0f0203',
      '--surface-contrast-rgb': '15, 2, 3',
      '--grid-color': 'rgba(255, 110, 70, 0.28)',
      '--grid-line': 'rgba(var(--accent-amber-rgb), 0.18)',
      '--text-primary': '#ffe9e4',
      '--text-primary-rgb': '255, 233, 228',
      '--text-secondary': '#f7b8a0',
      '--text-secondary-rgb': '247, 184, 160',
      '--accent-primary': '#ff7043',
      '--accent-primary-rgb': '255, 112, 67',
      '--accent-secondary': '#ffb347',
      '--accent-secondary-rgb': '255, 179, 71',
      '--accent-tertiary': '#ffd4c8',
      '--accent-tertiary-rgb': '255, 212, 200',
      '--accent-amber': '#ffb347',
      '--accent-amber-rgb': '255, 179, 71',
      '--accent-emerald': '#ff8661',
      '--accent-emerald-rgb': '255, 134, 97',
      '--accent-cyan': '#ffd8c8',
      '--accent-cyan-rgb': '255, 216, 200',
      '--accent-pink': '#ff8a7a',
      '--accent-pink-rgb': '255, 138, 122',
      '--terminal-border': 'rgba(255, 112, 67, 0.36)',
      '--horizon-warm': 'rgba(255, 120, 72, 0.62)',
      '--horizon-hot': 'rgba(255, 168, 96, 0.5)',
      '--horizon-cool': 'rgba(186, 80, 62, 0.38)',
      '--bg-linear-0': 'rgba(32, 6, 8, 0.98)',
      '--bg-linear-1': 'rgba(52, 10, 14, 0.94)',
      '--bg-linear-2': 'rgba(82, 16, 20, 0.9)',
      '--bg-linear-3': 'rgba(138, 32, 26, 0.62)',
      '--bg-linear-4': 'rgba(198, 58, 34, 0.52)',
      '--bg-linear-5': 'rgba(240, 104, 46, 0.4)',
      '--bg-linear-6': 'rgba(24, 4, 6, 0.92)',
      '--bg-radial-1': 'rgba(255, 110, 70, 0.32)',
      '--bg-radial-2': 'rgba(var(--accent-amber-rgb), 0.24)',
      '--bg-before-radial-strong': 'rgba(255, 120, 72, 0.64)',
      '--bg-before-radial-soft': 'rgba(255, 162, 104, 0.14)',
      '--bg-before-linear-top': 'rgba(26, 6, 8, 0.1)',
      '--bg-before-linear-mid': 'rgba(32, 8, 10, 0.48)',
      '--bg-before-linear-bottom': 'rgba(20, 4, 6, 0.94)',
      '--bg-before-glow': 'rgba(255, 128, 76, 0.26)',
      '--bg-after-grid': 'rgba(255, 214, 188, 0.08)',
      '--bg-after-star-1': 'rgba(255, 198, 154, 0.46)',
      '--bg-after-star-2': 'rgba(255, 122, 96, 0.36)',
      '--bg-after-star-3': 'rgba(255, 172, 110, 0.34)',
      '--bg-after-star-4': 'rgba(255, 226, 160, 0.3)',
      '--bg-after-star-5': 'rgba(255, 176, 130, 0.28)',
      '--bg-after-star-6': 'rgba(255, 128, 96, 0.32)',
      '--bg-after-haze-top': 'rgba(32, 6, 8, 1)',
      '--bg-after-haze-bottom': 'rgba(32, 6, 8, 0)',
    },
  }),
  eva00: createTheme({
    id: 'eva00',
    label: 'EVA-00',
    tokens: {
      '--surface-base': '#11161e',
      '--surface-base-rgb': '17, 22, 30',
      '--surface-elevated': '#171c24',
      '--surface-elevated-rgb': '23, 28, 36',
      '--surface-contrast': '#0a0d12',
      '--surface-contrast-rgb': '10, 13, 18',
      '--grid-color': 'rgba(246, 197, 71, 0.24)',
      '--grid-line': 'rgba(182, 194, 214, 0.18)',
      '--text-primary': '#f8f8f5',
      '--text-primary-rgb': '248, 248, 245',
      '--text-secondary': '#dcd7c9',
      '--text-secondary-rgb': '220, 215, 201',
      '--accent-primary': '#f6c547',
      '--accent-primary-rgb': '246, 197, 71',
      '--accent-secondary': '#aeb5c2',
      '--accent-secondary-rgb': '174, 181, 194',
      '--accent-tertiary': '#ffffff',
      '--accent-tertiary-rgb': '255, 255, 255',
      '--accent-amber': '#f6c547',
      '--accent-amber-rgb': '246, 197, 71',
      '--accent-emerald': '#b8c6d8',
      '--accent-emerald-rgb': '184, 198, 216',
      '--accent-cyan': '#dce7ff',
      '--accent-cyan-rgb': '220, 231, 255',
      '--accent-pink': '#f7ede0',
      '--accent-pink-rgb': '247, 237, 224',
      '--terminal-border': 'rgba(246, 197, 71, 0.32)',
      '--horizon-warm': 'rgba(246, 197, 71, 0.6)',
      '--horizon-hot': 'rgba(198, 178, 120, 0.48)',
      '--horizon-cool': 'rgba(120, 144, 170, 0.34)',
      '--bg-linear-0': 'rgba(22, 24, 28, 0.98)',
      '--bg-linear-1': 'rgba(30, 32, 40, 0.95)',
      '--bg-linear-2': 'rgba(44, 46, 58, 0.9)',
      '--bg-linear-3': 'rgba(92, 84, 60, 0.58)',
      '--bg-linear-4': 'rgba(148, 128, 72, 0.46)',
      '--bg-linear-5': 'rgba(206, 170, 72, 0.36)',
      '--bg-linear-6': 'rgba(20, 22, 26, 0.92)',
      '--bg-radial-1': 'rgba(246, 197, 71, 0.3)',
      '--bg-radial-2': 'rgba(164, 178, 201, 0.24)',
      '--bg-before-radial-strong': 'rgba(246, 197, 71, 0.6)',
      '--bg-before-radial-soft': 'rgba(246, 197, 71, 0.1)',
      '--bg-before-linear-top': 'rgba(20, 22, 28, 0.08)',
      '--bg-before-linear-mid': 'rgba(22, 24, 32, 0.48)',
      '--bg-before-linear-bottom': 'rgba(18, 20, 28, 0.94)',
      '--bg-before-glow': 'rgba(246, 197, 71, 0.24)',
      '--bg-after-grid': 'rgba(245, 245, 245, 0.08)',
      '--bg-after-star-1': 'rgba(255, 255, 255, 0.45)',
      '--bg-after-star-2': 'rgba(224, 214, 180, 0.38)',
      '--bg-after-star-3': 'rgba(168, 184, 210, 0.36)',
      '--bg-after-star-4': 'rgba(255, 214, 132, 0.3)',
      '--bg-after-star-5': 'rgba(210, 216, 226, 0.26)',
      '--bg-after-star-6': 'rgba(246, 197, 71, 0.32)',
      '--bg-after-haze-top': 'rgba(22, 24, 28, 1)',
      '--bg-after-haze-bottom': 'rgba(22, 24, 28, 0)',
    },
  }),
};

export const DEFAULT_THEME_ID: ThemeId = 'eoe';

export const THEME_LIST = Object.values(THEME_MANIFEST);

export function buildThemeCss(classPrefix: string) {
  return THEME_LIST.map(({ id, tokens }) => {
    const declarations = Object.entries(tokens)
      .map(([key, value]) => `${key}: ${value};`)
      .join('');
    return `.${classPrefix}${id}{${declarations}}`;
  }).join('\n');
}
